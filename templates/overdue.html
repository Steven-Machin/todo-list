{% extends 'base.html' %}

{% block title %}Overdue Tasks - To Do App{% endblock %}

{% block content %}
<div class="container overdue-page">
  <h1>Overdue Tasks</h1>

  {% if overdue %}
    <ul class="task-list">
      {% for entry in overdue %}
        {% set task = entry.task %}
        <li class="task-item overdue">
          <div class="task-header">
            <span class="task-text">{{ task.text or 'Untitled Task' }}</span>
          </div>
          <div class="task-meta">
            <span class="priority {{ (task.priority or 'Medium')|lower }}">Priority: {{ task.priority or 'Medium' }}</span>
            {% if task.assigned_to %}
              <span class="assigned">Assigned to: {{ task.assigned_to }}</span>
            {% endif %}
            <span class="due">Due: {{ entry.due_display }}</span>
            {% if task.created_at %}
              <span class="created">Created: {{ task.created_at.split('T')[0] }}</span>
            {% endif %}
          </div>
          {% if task.notes %}
            <div class="task-notes">
              <strong>Notes:</strong> {{ task.notes }}
            </div>
          {% endif %}
          {% if current_role == 'manager' %}
            <div class="task-actions">
              <a href="{{ url_for('edit', task_id=entry.idx) }}">Edit</a>
              <a href="{{ url_for('remove', task_id=entry.idx) }}">Remove</a>
            </div>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="empty-state">You're all caught up - no overdue tasks right now.</p>
  {% endif %}

  <p class="return-link" style="text-align:right;">
    {% if current_role == 'manager' %}
      <a href="{{ url_for('tasks_page') }}">Back to Task Manager</a>
    {% else %}
      <a href="{{ url_for('index') }}">Back to Home</a>
    {% endif %}
  </p>
</div>
{% endblock %}
