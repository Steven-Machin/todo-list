<!DOCTYPE html>
<html>
<head>
    <title>Team Member Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
        <div class="sidebar">
            <h2>Menu</h2>
            <a href="/">Home</a>
            <a href="/tasks">Task Manager</a>
            <a href="/titles">Team Member Manager</a>
            <a href="/groups">Group Chats</a>
            <a href="/settings">Settings</a>
            <a href="/logout">Logout</a>
        </div>

        <div class="main-content">
            <div class="container">
                <h1>Team Member Manager</h1>

                <!-- Title Creation Form -->
                <form method="post" action="{{ url_for('title_manager') }}" style="margin-bottom: 20px;">
                    <label for="new_title">Create New Title:</label>
                    <input type="text" name="new_title" required placeholder="e.g., Lead Teacher">
                    <button type="submit">Add Title</button>
                </form>

                {% if categorized['Untitled'] %}
                    <h2>Untitled</h2>
                    <ul>
                        {% for user in categorized['Untitled'] %}
                            <li>
                                <strong>{{ user.display_name }}</strong><br>
                                Current Titles: None<br>
                                <form method="post" action="{{ url_for('update_titles') }}">
                                    <label for="titles_{{ user.username }}">Assign Title:</label>
                                    <select name="titles_{{ user.username }}">
                                        <option value="">-- Select Title --</option>
                                        {% for t in all_titles %}
                                            <option value="{{ t }}">{{ t }}</option>
                                        {% endfor %}
                                    </select>
                                    <button type="submit">Save</button>
                                </form>
                                <a href="#">View Profile (coming soon)</a>
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}

                {% for title, users in categorized.items() %}
                    {% if title != 'Untitled' %}
                        <h2>{{ title }}</h2>
                        <ul>
                            {% for user in users %}
                                <li>
                                    <strong>{{ user.display_name }}</strong><br>
                                    Current Titles: {{ user.titles | join(', ') if user.titles else 'None' }}<br>
                                    <form method="post" action="{{ url_for('update_titles') }}">
                                        <label for="titles_{{ user.username }}">Assign Title:</label>
                                        <select name="titles_{{ user.username }}">
                                            <option value="">-- Select Title --</option>
                                            {% for t in all_titles %}
                                                <option value="{{ t }}" {% if t in user.titles %}selected{% endif %}>{{ t }}</option>
                                            {% endfor %}
                                        </select>
                                        <button type="submit">Save</button>
                                    </form>
                                    <a href="#">View Profile (coming soon)</a>
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                {% endfor %}

                <a href="/">Back to Home</a>
            </div>
        </div>
    </div>
</body>
</html>
